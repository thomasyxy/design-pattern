<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>更强大的宏命令</title>
  </head>
  <body>
    <button id="button">按我</button>
    <script type="text/javascript">
      var MacroCommand = function(){
        return {
          commandsList: [],
          add: function(command){
            this.commandsList.push(command);
          },
          excute: function(){
            for(var i = 0, command; command = this.commandsList[i++]; ){
              command.excute();
            }
          }
        }
      };

      var openAcCommand = {
        excute: function(){
          console.log('打开空调');
        }
      };

      var openTvCommand = {
        excute: function(){
          console.log('打开电视');
        }
      };

      var openSoundCommand = {
        excute: function(){
          console.log('打开音响');
        }
      };

      var macroCommand1 = MacroCommand();
      macroCommand1.add(openTvCommand);
      macroCommand1.add(openSoundCommand);

      var closeDoorCommand = {
        excute: function(){
          console.log('关门');
        }
      };

      var openPcCommand = {
        excute: function(){
          console.log('开电脑');
        }
      };

      var openQQCommand = {
        excute: function(){
          console.log('登录QQ');
        }
      };

      var macroCommand2 = MacroCommand();
      macroCommand2.add(closeDoorCommand);
      macroCommand2.add(openPcCommand);
      macroCommand2.add(openQQCommand);

      var macroCommand = MacroCommand();
      macroCommand.add(openAcCommand);
      macroCommand.add(macroCommand1);
      macroCommand.add(macroCommand2);

      var setCommand = (function(command){
        document.getElementById('button').onclick = function(){
          command.excute();
        }
      })(macroCommand);
    </script>
  </body>
</html>
